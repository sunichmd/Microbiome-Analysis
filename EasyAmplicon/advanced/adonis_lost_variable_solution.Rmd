
ğŸ“Œ åŸå› ï¼š
adonis() ä½¿ç”¨çš„æ˜¯é¡ºåºå‹ Type I æ–¹å·®åˆ†æï¼ˆsequential sums of squaresï¼‰ï¼Œå³ï¼š

å…ˆè§£é‡Šå‰é¢çš„å˜é‡ï¼Œå‰©ä¸‹çš„æ®‹å·®æ‰ç•™ç»™åé¢çš„å˜é‡è§£é‡Šã€‚

ğŸ‘‰ æ‰€ä»¥ å‰é¢çš„å˜é‡å¦‚æœå·²ç»å¸æ”¶äº†åé¢å˜é‡çš„éƒ¨åˆ†å˜å¼‚ï¼Œåé¢çš„å˜é‡è§£é‡Šé‡ä¼šè¢«ä½ä¼°ç”šè‡³ä¸º 0ã€‚

```{r}
setwd("C:\\0amplicon\\test")
metadata = read.table("metadata.txt", header=T, row.names=1, sep="\t", comment.char="", stringsAsFactors = F)
head(metadata, n = 3)
# colnames of group ID in metadata
# è®¾ç½®å®éªŒåˆ†ç»„åˆ—å
group = "Group2"
# Output figure width and height  
# Letterçº¸å›¾ç‰‡å°ºå¯¸ä¸ºå•æ 89 mmï¼ŒåŒæ 183 mmï¼Œé¡µé¢æœ€å®½ä¸º247 mm
# æ¨èæ¯”ä¾‹16ï¼š10ï¼Œå³åŠç‰ˆ89 mm x 56 mm; 183 mm x 114 mm
width = 89
height = 59

distance_type = "bray_curtis"
# Data reading
distance_mat = read.table(paste0(distance_type,".txt"), header=T, row.names=1, sep="\t", comment.char="")
distance_mat[1:3, 1:3]

# Explanation rate of variablesä»…æŸ¥çœ‹åˆ†ç»„å¯¹ç¾¤è½çš„è§£é‡Š
adonis_var <- adonis (as.dist(distance_mat) ~ Group2, data = metadata, by=NULL, parallel=4)
adonis_var$aov.tab

# âœ… è‹¥å¯¹äº¤äº’ä½œç”¨æœ‰å…´è¶£ï¼ˆå¦‚æ˜¯å¦å­˜åœ¨äº¤äº’è°ƒæ§ï¼‰
adonis_var <- adonis (as.dist(distance_mat) ~ Group1*Group2*Group3, data = metadata, by=NULL, parallel=4)
adonis_var$aov.tab

adonis_var1 <- adonis (as.dist(distance_mat) ~ Group3*Group2, data = metadata, by=NULL, parallel=4)
adonis_var1$aov.tab

adonis_var2 <- adonis (as.dist(distance_mat) ~ Group3*Group2*Group1, data = metadata, by=NULL, parallel=4)
adonis_var2$aov.tab

adonis_var3 <- adonis (as.dist(distance_mat) ~ Group3*Group1*Group2, data = metadata, by=NULL, parallel=4)
adonis_var3$aov.tab

# âœ…âœ”ï¸ã€æ¨èæ–¹æ³•ã€‘ä½¿ç”¨adonis2 + by="margin"ï¼Œå³ Type IIIï¼ˆæ¯ä¸ªå˜é‡åœ¨æ§åˆ¶å…¶ä»–å˜é‡æ¡ä»¶ä¸‹è§£é‡Šçš„ç‹¬ç«‹è´¡çŒ®ï¼‰
adonis_var4 <- adonis2(as.dist(distance_mat) ~ Group2+Group3+Group1, data = metadata,by="margin")
adonis_var4

# âœ… dbrdaä¹Ÿæ”¯æŒç±»å‹ III åˆ†æï¼ˆå¼ºæ¨èç”¨äºç»„é—´å¯è§†åŒ–ï¼‰
adonis_var5 <- dbrda (as.dist(distance_mat) ~ Group1 + Group2 + Group3, data = metadata)
anova(adonis_var5,by="margin")
```


